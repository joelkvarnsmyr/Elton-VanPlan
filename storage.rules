rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Files are stored under /receipts/{userId}/{projectId}/{fileId}
    match /receipts/{userId}/{projectId}/{allPaths=**} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // Chat images are stored under /chat-images/{projectId}/{fileId}
    match /chat-images/{projectId}/{allPaths=**} {
      allow read, write: if request.auth != null;
    }

    // Inspection images/audio are stored under /inspections/images/{projectId}/{fileId}
    match /inspections/images/{projectId}/{allPaths=**} {
      allow read, write: if request.auth != null;
    }
    match /inspections/audio/{projectId}/{allPaths=**} {
      allow read, write: if request.auth != null;
    }
  }
}